<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#23565;&#35441;&#27969;&#31243; </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#23565;&#35441;&#27969;&#31243; ">
    <meta name="generator" content="docfx 2.58.9.0">
    <meta name="google-site-verification" content="wackHW3mx9OzoWNdH73Ucfx-Tgn27NaVqlQ-dzKaBfw">
    
    <link rel="shortcut icon" href="../../../../images/favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="對話流程">對話流程</h1>

<p>用於流程式基本對話，用來補足領域式對話限制流程缺點。</p>
<h2 id="優點">優點</h2>
<ul>
<li>圖示化展示，更直覺的了解節點跟節點的關係位置。</li>
<li>拖曳式節點，相對於傳統cli寫程式的機器人套件，更能滿足一般使用者撰寫流程。</li>
</ul>
<p><img src="../../../../images/docs/Image049.png" alt=""></p>
<ul>
<li>1.新流程:用於刷新此流程，會將當前所有設定變為原來的設定包含情境以及節點。</li>
<li>2.保存:新增、載入版本流程。</li>
<li>3.更新:用於更新當前版本。</li>
<li>4.挑選情境:跳出視窗可以新增、更新、刪除、選擇情境</li>
<li>5.放大:畫布放大。</li>
<li>6.歸位:畫布歸位跟start節點對齊。</li>
<li>7.縮小:畫布縮小。</li>
<li>8.全局設定:重載選項。</li>
<li>9.全螢幕</li>
<li>10.模板:分為記憶模板以及對話模板。</li>
<li>11.測試:用於測試當前機器人流程。</li>
<li>12.暫存流程:當一定時間內會更新當前流程緩存，使用者可以去其他頁面處理任務。</li>
<li>13.節點設定:資源、回覆、情境、變數、收集以及調用節點設定。</li>
</ul>
<h2 id="保存">保存</h2>
<p><img src="../../../../images/docs/Image124.png" alt=""></p>
<ul>
<li>1.新增新的版本。</li>
<li>2.版本名稱、狀態(完成代表成功)、更新原因、預先載入以及是否發布</li>
<li>3.編輯 可以重寫更新原因，以及預先載入以及是否發布</li>
<li>4.載入選中版本腳本。</li>
<li>5.瀏覽歷史紀錄。</li>
</ul>
<h3 id="預先載入">預先載入</h3>
<p>當版本有勾選預先載入，則第一次進去流程畫布，會優先載入此腳本，而非最新日期的腳本。</p>
<h3 id="是否發布">是否發布</h3>
<p>當版本勾選是否發布，則表示將發布成&quot;開發版本&quot;，可使用於測試。</p>
<h2 id="測試">測試</h2>
<p><img src="../../../../images/docs/Image123.png" alt=""></p>
<ul>
<li>1.輸入詢問句。</li>
<li>2.可以直接測試該情境流程。</li>
<li>3.可根據視角選擇不同平台的回話方式。</li>
<li>4.用於測試生產版版本。</li>
<li>5.是否啟用業務資源服務，假設點取&quot;啟用&quot;，則會外呼資源節點。</li>
<li>6.若不啟用業務資源服務，可將模擬的參數填寫至此。</li>
<li>7.將該頁面重新填寫刷新。</li>
</ul>
<h1 id="節點介紹">節點介紹</h1>
<h2 id="開始節點">開始節點</h2>
<p>作為該情境全局節點，影響所有節點。<br>
<img src="../../../../images/docs/Image050.png" alt=""></p>
<ul>
<li>1.詢問:用於開場問話。</li>
<li>2.模式:分為一般模式以及喚醒模式。喚醒模式，需要用戶輸入&quot;喚醒句&quot;相等才會進入。</li>
<li>3.預載領域:必須是意圖型，為了後面收集節點使用。</li>
<li>4.此為顯示使用&quot;預載領域&quot;的節點。</li>
<li>5.對話模板，用於不同渠道的模板，一般是回答&quot;詢問&quot;，假如不同渠道又不同問話，則會自動用該渠道回答用戶。</li>
</ul>
<h2 id="資源節點">資源節點</h2>
<p>可以呼叫外界資源，進行業務邏輯。<br>
<img src="../../../../images/docs/Image051.png" alt=""></p>
<ul>
<li>1.參數的前綴分為config(機器人參數)、constant(常數)、conversation(單輪會話)、session(多輪會話)、slots(詞槽)、sys_user(系統使用者參數)、user(使用者參數)</li>
<li>2.回傳值的前綴分為conversation(單輪會話)、session(多輪會話)以及、user(使用者參數)</li>
<li>3.參數的屬性如果是datetime以及number，此時前綴選取constant時，只能填入數字，為string時可以填入任何文字，其餘僅支援大小寫a到z。</li>
</ul>
<h3 id="前綴介紹">前綴介紹</h3>
<p>前綴分為機器人參數、常數、單輪會話、多輪會話、詞槽、系統使用者參數以及使用者參數。</p>
<ul>
<li>機器人參數:模板-&gt;記憶模板-&gt;機器人參數</li>
<li>常數:輸入的文字為字串。</li>
<li>單輪對話:要查看是否有文字注入。</li>
<li>多輪對話:模板-&gt;記憶模板-&gt;單一會話儲存</li>
<li>詞槽:根據&quot;預載領域&quot;注入該領域詞槽。</li>
<li>系統使用者參數:模板-&gt;記憶模板-&gt;使用者參數(預設)[目前僅提供userId]</li>
<li>使用者參數:模板-&gt;記憶模板-&gt;使用者參數。</li>
</ul>
<h3 id="消息接收非文字類">消息接收非文字類</h3>
<p>如果用於line和messenger接收非文字訊息時，有保留字</p>
<ul>
<li>conversation._queryType 用於判斷text, image, audio, video, event, file</li>
<li>conversaion.@line 和 conversaion.@fbmessenger 接收到非text和event時啟用。</li>
</ul>
<pre><code>{
  &quot;@line&quot;: {
    &quot;attachments&quot;: [
      {
        &quot;id&quot;: &quot;att_id&quot;,
        &quot;url&quot;: &quot;att_url&quot;,
        &quot;type&quot;: &quot;att_type&quot;
      }
    ]
  }
}
</code></pre>
<p>若為file且平台有提供fileName和fileSize時，一樣會提供</p>
<pre><code>{
  &quot;@line&quot;: {
    &quot;attachments&quot;: [
      {
        &quot;id&quot;: &quot;att_id&quot;,
        &quot;url&quot;: &quot;att_url&quot;,
        &quot;type&quot;: &quot;att_type&quot;,
        &quot;fileName&quot;: &quot;fileName&quot;,
        &quot;fileSize&quot;: 10240
      }
    ]
  }
}
</code></pre>
<p>相同於@fbmessenger</p>
<pre><code>{
  &quot;@fbmessenger&quot;: {
    &quot;attachments&quot;: [
      {
        &quot;id&quot;: &quot;att_id&quot;,
        &quot;url&quot;: &quot;att_url&quot;,
        &quot;type&quot;: &quot;att_type&quot;
      }
    ]
  }
}
</code></pre>
<table>
<thead>
<tr>
<th>PATH</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>對應平台是否提供特定id，messenger可以事前上傳檔案</td>
</tr>
<tr>
<td>url</td>
<td>對應平台是否提供特定url</td>
</tr>
<tr>
<td>type</td>
<td>text, image, audio, video, event, file</td>
</tr>
<tr>
<td>fileName</td>
<td>當type=file時，若平台有提供即會顯示</td>
</tr>
<tr>
<td>fileSize</td>
<td>當type=file時，若平台有提供即會顯示</td>
</tr>
</tbody>
</table>
<p>如何使用</p>
<ul>
<li>當節點為&quot;條件節點&quot;時，可以先判斷conversation._queryType 型態為何。</li>
<li>再透過&quot;資源節點&quot;，把attachments傳出去後端做處理。</li>
</ul>
<h4 id="參數介紹">參數介紹</h4>
<p>將數值注入到資源裡面。</p>
<p>假設conversation.test裡面的值為&quot;測試&quot;，請求參數將會把 city=測試 傳遞出去。</p>
<h4 id="回傳值">回傳值</h4>
<p>將資源回應的JSON[目前只支援JSON回傳]回傳給對話系統。</p>
<p>假設得到的數值是&quot;測試&quot;，則注入到conversation.test的數值將會是&quot;測試&quot;。</p>
<h2 id="回覆節點">回覆節點</h2>
<p>一般節點使用，可以用作提問問題或是回答問題。<br>
<img src="../../../../images/docs/Image052.png" alt=""></p>
<ul>
<li>1.選擇詢問型態:目前支援單純問題。</li>
<li>2.文字表現:目前僅支援隨機。</li>
<li>3.回答:可複數，若有N個回答，機率就是1/N</li>
<li>4.等待用戶回復:當選取此時，在此階段會停止，直到用戶回應後，才繼續跑流程。</li>
<li>5.打斷啟動:打斷用於&quot;開始節點&quot;的分支條件。</li>
<li>6.對話模板，用於不同渠道的模板，一般是回答&quot;詢問&quot;，假如不同渠道又不同問話，則選取該渠道回答用戶。</li>
</ul>
<h2 id="情境節點">情境節點</h2>
<p>情境節點的移動。<br>
<img src="../../../../images/docs/Image053.png" alt=""></p>
<ul>
<li>1.情境操作分為打斷、重新開始、重回主情境、完成、結束流程、聆聽以及跳轉。</li>
<li>2.清除所有當前殂存的詞槽。</li>
<li>3.清除&quot;模板&quot;-&gt;&quot;記憶模板&quot;-&gt;&quot;單一會話儲存&quot;的所有資料。</li>
</ul>
<h3 id="情境操作">情境操作</h3>
<ul>
<li>打斷:可選其他情境作跳轉，當完成後會繼續該節點。</li>
<li>重新開始:重新該情境。</li>
<li>重回主情境，一般重回&quot;主情境&quot;，但不同渠道或API有攜帶情境參數時，將以該參數為主。</li>
<li>完成:將跳回上一個情境，若無上一個情境則重新開始當前情境。</li>
<li>結束流程:將對話結束，若為喚醒模式，必須重新輸入喚醒詞才會進去對話。</li>
<li>聆聽:該用戶輸入任何問句都不會觸發，直到問句等同於開始節點的喚醒句才可以醒來。特別注意:要使用此情境，需再開始結點設定喚醒句。</li>
<li>跳轉:可以任意跳轉該情境內任一&quot;回覆節點&quot;。</li>
</ul>
<h2 id="變數節點">變數節點</h2>
<p>變數節點作為參數變動，賦予變數模板數值的地方。<br></p>
<p><img src="../../../../images/docs/Image054.png" alt=""></p>
<h3 id="操作型態">操作型態</h3>
<ul>
<li>詞槽:包含開始節點選擇的意圖詞槽。</li>
<li>變數:包含單一會話(session)以及使用者(user)變數</li>
<li>系統參數:目前僅支援&quot;使用者標籤&quot;。</li>
</ul>
<h3 id="操作">操作</h3>
<ul>
<li>當來源為列表時，會有列表新增、列表刪除。</li>
<li>當來源為時間時，會有字串取代。</li>
<li>當來源為字串時，會有字串取代以及字串清空。</li>
<li>當來源為數字時，會有歸零、加一以及減一可以選擇。</li>
</ul>
<h2 id="收集節點">收集節點</h2>
<p>收集節點為意圖型的簡單化收集詞槽。<br>
<img src="../../../../images/docs/Image055.png" alt=""></p>
<ul>
<li>1.詢問</li>
<li>2.當超過&quot;最大失敗次數&quot;，將會丟出conversation.{qaId}.fallback</li>
<li>3.選擇開始節點，指定領域中的意圖型。</li>
<li>4.選擇開始節點，指定領域中的所有詞槽。</li>
<li>5.設定該詞槽預設內容，若用戶對話沒命中則使用。</li>
<li>6.設定該詞槽預設正規化(數字、日期等)，若用戶對話沒命中則使用。</li>
</ul>
<h2 id="調用節點">調用節點</h2>
<p>調用不同的領域
<img src="../../../../images/docs/Image068.png" alt="">
當&quot;開啟&quot;覆蓋，將會覆蓋掉本來在領域內的參數。</p>
<h2 id="條件節點">條件節點</h2>
<p><img src="../../../../images/docs/Image125.png" alt=""></p>
<ul>
<li>1.分支條件：分為有條件、無條件以及百分比</li>
<li>2.優先順序：可透過優先順序去排序分支條件先後順序，若相同順序，根據節點位置坐排序。</li>
<li>3.有條件的觸發條件</li>
<li>4.組別，同組為AND，不同組為OR，根據組別順序檢查，當結果為TRUE則執行下一個節點。</li>
</ul>
<h3 id="分支條件">分支條件</h3>
<ul>
<li>有條件，根據不同條件前往不同節點。</li>
<li>無條件，直接連線到其他節點。</li>
<li>百分比，根據機率前往不同節點。</li>
</ul>
<h3 id="觸發條件">觸發條件</h3>
<ul>
<li>意圖</li>
<li>詞槽</li>
<li>變數</li>
<li>詢問</li>
</ul>
<h1 id="接著讀">接著讀</h1>
<ul>
<li><a href="../../tutorials/docs/bot-example.html">機器人範例</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Copyright © (2023) Communeify</span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
